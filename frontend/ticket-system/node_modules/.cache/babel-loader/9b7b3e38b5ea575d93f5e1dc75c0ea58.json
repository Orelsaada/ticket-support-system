{"ast":null,"code":"var _jsxFileName = \"F:\\\\react-small-projects\\\\ticket-support-system\\\\frontend\\\\ticket-system\\\\src\\\\components\\\\LoginPage.js\";\nimport React, { useState, useEffect, useContext } from \"react\";\nimport { useHistory } from \"react-router\";\nimport axios from \"axios\";\nimport { AuthContext } from \"./AuthContext\";\nimport \"./componentsStyles/LoginPage.css\";\n\nconst LoginPage = () => {\n  const [myInputs, setMyInputs] = useState({});\n  const [error, setError] = useState(\"\");\n  const [isAuthenticated, setIsAuthenticated] = useContext(AuthContext);\n  const history = useHistory(); // If token in localstorage, validate token and connect.\n\n  useEffect(() => {\n    if (localStorage.getItem(\"token\")) {\n      axios({\n        method: \"post\",\n        url: \"http://localhost:5000/api/auth/isValidToken\"\n      }).then(res => {\n        // res.data contain user object and token string.\n        console.log(res);\n      });\n    }\n  }, [localStorage]); // Handle form changes\n\n  const handleChange = e => {\n    setMyInputs({ ...myInputs,\n      [e.target.name]: e.target.value\n    });\n  }; // Handle login\n\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    const user = {\n      email: myInputs.email,\n      password: myInputs.password\n    };\n    setError(\"\");\n    axios({\n      method: \"post\",\n      url: \"http://localhost:5000/api/auth\",\n      data: user\n    }).then(res => {\n      // res.data contain user object and token string.\n      if (res.data.token) {\n        localStorage.setItem(\"token\", res.data.token);\n        localStorage.setItem(\"user-id\", res.data.user.id);\n        setIsAuthenticated(true);\n        history.push(\"/my-incidents\");\n      }\n    }).catch(err => setError(\"Failed to login, try again.\"));\n  };\n\n  return /*#__PURE__*/React.createElement(\"section\", {\n    className: \"login-section\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"main-div\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  }, \"Testing user: \\\"token@user.com\\\", password: 123456\"), error && /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 19\n    }\n  }, error), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"mt-4 mb-4 text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 11\n    }\n  }, \"Login\"), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"email\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 15\n    }\n  }, \"Email\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"email\",\n    className: \"form-control\",\n    id: \"email\",\n    name: \"email\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 15\n    }\n  }, \"Password\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"password\",\n    className: \"form-control\",\n    id: \"password\",\n    name: \"password\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"btn btn-dark\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }\n  }, \"Login\")))));\n};\n\nexport default LoginPage;","map":{"version":3,"sources":["F:/react-small-projects/ticket-support-system/frontend/ticket-system/src/components/LoginPage.js"],"names":["React","useState","useEffect","useContext","useHistory","axios","AuthContext","LoginPage","myInputs","setMyInputs","error","setError","isAuthenticated","setIsAuthenticated","history","localStorage","getItem","method","url","then","res","console","log","handleChange","e","target","name","value","handleSubmit","preventDefault","user","email","password","data","token","setItem","id","push","catch","err"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,UAArC,QAAuD,OAAvD;AACA,SAASC,UAAT,QAA2B,cAA3B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,WAAT,QAA4B,eAA5B;AACA,OAAO,kCAAP;;AAEA,MAAMC,SAAS,GAAG,MAAM;AACtB,QAAM,CAACC,QAAD,EAAWC,WAAX,IAA0BR,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAACS,KAAD,EAAQC,QAAR,IAAoBV,QAAQ,CAAC,EAAD,CAAlC;AACA,QAAM,CAACW,eAAD,EAAkBC,kBAAlB,IAAwCV,UAAU,CAACG,WAAD,CAAxD;AACA,QAAMQ,OAAO,GAAGV,UAAU,EAA1B,CAJsB,CAMtB;;AACAF,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIa,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAJ,EAAmC;AACjCX,MAAAA,KAAK,CAAC;AACJY,QAAAA,MAAM,EAAE,MADJ;AAEJC,QAAAA,GAAG,EAAE;AAFD,OAAD,CAAL,CAGGC,IAHH,CAGSC,GAAD,IAAS;AACf;AACAC,QAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACD,OAND;AAOD;AACF,GAVQ,EAUN,CAACL,YAAD,CAVM,CAAT,CAPsB,CAmBtB;;AACA,QAAMQ,YAAY,GAAIC,CAAD,IAAO;AAC1Bf,IAAAA,WAAW,CAAC,EACV,GAAGD,QADO;AAEV,OAACgB,CAAC,CAACC,MAAF,CAASC,IAAV,GAAiBF,CAAC,CAACC,MAAF,CAASE;AAFhB,KAAD,CAAX;AAID,GALD,CApBsB,CA2BtB;;;AACA,QAAMC,YAAY,GAAIJ,CAAD,IAAO;AAC1BA,IAAAA,CAAC,CAACK,cAAF;AAEA,UAAMC,IAAI,GAAG;AAAEC,MAAAA,KAAK,EAAEvB,QAAQ,CAACuB,KAAlB;AAAyBC,MAAAA,QAAQ,EAAExB,QAAQ,CAACwB;AAA5C,KAAb;AACArB,IAAAA,QAAQ,CAAC,EAAD,CAAR;AAEAN,IAAAA,KAAK,CAAC;AACJY,MAAAA,MAAM,EAAE,MADJ;AAEJC,MAAAA,GAAG,EAAE,gCAFD;AAGJe,MAAAA,IAAI,EAAEH;AAHF,KAAD,CAAL,CAKGX,IALH,CAKSC,GAAD,IAAS;AACb;AACA,UAAIA,GAAG,CAACa,IAAJ,CAASC,KAAb,EAAoB;AAClBnB,QAAAA,YAAY,CAACoB,OAAb,CAAqB,OAArB,EAA8Bf,GAAG,CAACa,IAAJ,CAASC,KAAvC;AACAnB,QAAAA,YAAY,CAACoB,OAAb,CAAqB,SAArB,EAAgCf,GAAG,CAACa,IAAJ,CAASH,IAAT,CAAcM,EAA9C;AACAvB,QAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACAC,QAAAA,OAAO,CAACuB,IAAR,CAAa,eAAb;AACD;AACF,KAbH,EAcGC,KAdH,CAcUC,GAAD,IAAS5B,QAAQ,CAAC,6BAAD,CAd1B;AAeD,GArBD;;AAuBA,sBACE;AAAS,IAAA,SAAS,EAAC,eAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0DADF,EAEGD,KAAK,iBAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAIA,KAAJ,CAFZ,eAGE;AAAK,IAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAI,IAAA,SAAS,EAAC,uBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADF,eAEE;AAAM,IAAA,QAAQ,EAAEkB,YAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAO,IAAA,OAAO,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADF,eAEE;AACE,IAAA,IAAI,EAAC,OADP;AAEE,IAAA,SAAS,EAAC,cAFZ;AAGE,IAAA,EAAE,EAAC,OAHL;AAIE,IAAA,IAAI,EAAC,OAJP;AAKE,IAAA,QAAQ,EAAEL,YALZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CADF,eAWE;AAAK,IAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAO,IAAA,OAAO,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AACE,IAAA,IAAI,EAAC,UADP;AAEE,IAAA,SAAS,EAAC,cAFZ;AAGE,IAAA,EAAE,EAAC,UAHL;AAIE,IAAA,IAAI,EAAC,UAJP;AAKE,IAAA,QAAQ,EAAEA,YALZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CAXF,eAqBE;AAAQ,IAAA,IAAI,EAAC,QAAb;AAAsB,IAAA,SAAS,EAAC,cAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aArBF,CAFF,CAHF,CADF,CADF;AAoCD,CAvFD;;AAyFA,eAAehB,SAAf","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\r\nimport { useHistory } from \"react-router\";\r\nimport axios from \"axios\";\r\nimport { AuthContext } from \"./AuthContext\";\r\nimport \"./componentsStyles/LoginPage.css\";\r\n\r\nconst LoginPage = () => {\r\n  const [myInputs, setMyInputs] = useState({});\r\n  const [error, setError] = useState(\"\");\r\n  const [isAuthenticated, setIsAuthenticated] = useContext(AuthContext);\r\n  const history = useHistory();\r\n\r\n  // If token in localstorage, validate token and connect.\r\n  useEffect(() => {\r\n    if (localStorage.getItem(\"token\")) {\r\n      axios({\r\n        method: \"post\",\r\n        url: \"http://localhost:5000/api/auth/isValidToken\",\r\n      }).then((res) => {\r\n        // res.data contain user object and token string.\r\n        console.log(res);\r\n      });\r\n    }\r\n  }, [localStorage]);\r\n\r\n  // Handle form changes\r\n  const handleChange = (e) => {\r\n    setMyInputs({\r\n      ...myInputs,\r\n      [e.target.name]: e.target.value,\r\n    });\r\n  };\r\n\r\n  // Handle login\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n\r\n    const user = { email: myInputs.email, password: myInputs.password };\r\n    setError(\"\");\r\n\r\n    axios({\r\n      method: \"post\",\r\n      url: \"http://localhost:5000/api/auth\",\r\n      data: user,\r\n    })\r\n      .then((res) => {\r\n        // res.data contain user object and token string.\r\n        if (res.data.token) {\r\n          localStorage.setItem(\"token\", res.data.token);\r\n          localStorage.setItem(\"user-id\", res.data.user.id);\r\n          setIsAuthenticated(true);\r\n          history.push(\"/my-incidents\");\r\n        }\r\n      })\r\n      .catch((err) => setError(\"Failed to login, try again.\"));\r\n  };\r\n\r\n  return (\r\n    <section className=\"login-section\">\r\n      <div className=\"main-div\">\r\n        <p>Testing user: \"token@user.com\", password: 123456</p>\r\n        {error && <p>{error}</p>}\r\n        <div className=\"card-container\">\r\n          <h2 className=\"mt-4 mb-4 text-center\">Login</h2>\r\n          <form onSubmit={handleSubmit}>\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"email\">Email</label>\r\n              <input\r\n                type=\"email\"\r\n                className=\"form-control\"\r\n                id=\"email\"\r\n                name=\"email\"\r\n                onChange={handleChange}\r\n              ></input>\r\n            </div>\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"password\">Password</label>\r\n              <input\r\n                type=\"password\"\r\n                className=\"form-control\"\r\n                id=\"password\"\r\n                name=\"password\"\r\n                onChange={handleChange}\r\n              ></input>\r\n            </div>\r\n            <button type=\"submit\" className=\"btn btn-dark\">\r\n              Login\r\n            </button>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default LoginPage;\r\n"]},"metadata":{},"sourceType":"module"}